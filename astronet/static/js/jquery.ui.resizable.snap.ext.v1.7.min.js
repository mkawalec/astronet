(function(a){function b(b,c,d){var e=a.ui.resizable.prototype[b];a.ui.resizable.prototype[b]=function(){if(d)d.apply(this,arguments);e.apply(this,arguments);if(c)c.apply(this,arguments);};}function c(a){return parseInt(a.css("margin-top"),10)||0;}function d(a){return parseInt(a.css("margin-left"),10)||0;}function e(a){return a.sort(function(a,b){return !a?1:!b?-1:Math.abs(a)-Math.abs(b);})[0];}function f(a,b,c){return Math.abs(a)<c?-a:Math.abs(b)<c?-b:0;}a.extend(a.ui.resizable.prototype.options,{snapTolerance:20,snapMode:"both"});a.ui.plugin.add("resizable","snap",{start:function(){var b=a(this),e=b.data("resizable"),f=e.options.snap;e.ow=e.helper.outerWidth()-e.size.width;e.oh=e.helper.outerHeight()-e.size.height;e.lm=d(b);e.tm=c(b);e.coords=[];a(typeof f=="string"?f:":data(resizable)").each(function(){if(this==e.element[0]||this==e.helper[0])return;var b=a(this),f=b.position(),g=f.left+d(b),h=f.top+c(b);e.coords.push({l:g,t:h,r:g+b.outerWidth(),b:h+b.outerHeight()});});},resize:function(){var b=[],c=[],d=[],g=[],h=a(this).data("resizable"),i=h.axis.split(""),j=h.options.snapTolerance,k=h.options.snapMode,l=h.position.left+h.lm,m=l-j,n=h.position.top+h.tm,o=n-j,p=l+h.size.width+h.ow,q=p+j,r=n+h.size.height+h.oh,s=r+j;a.each(h.coords,function(){var e=this,h=Math.min(q,e.r)-Math.max(m,e.l),t=Math.min(s,e.b)-Math.max(o,e.t);if(h<0||t<0)return;a.each(i,function(a,i){if(k=="outer"){switch(i){case "w":case "e":if(h>j*2)return;break;case "n":case "s":if(t>j*2)return;}}else if(k=="inner")switch(i){case "w":case "e":if(h<j*2)return;break;case "n":case "s":if(t<j*2)return;}switch(i){case "w":b.push(f(l-e.l,l-e.r,j));break;case "n":c.push(f(n-e.t,n-e.b,j));break;case "e":d.push(f(p-e.l,p-e.r,j));break;case "s":g.push(f(r-e.t,r-e.b,j));}});});if(g.length)h.size.height+=e(g);if(d.length)h.size.width+=e(d);if(b.length){var t=e(b);h.position.left+=t;h.size.width-=t;}if(c.length){var t=e(c);h.position.top+=t;h.size.height-=t;}}});b("_mouseStop",null,function(){if(this._helper){this.position={left:parseInt(this.helper.css("left"),10)||.1,top:parseInt(this.helper.css("top"),10)||.1};this.size={width:this.helper.outerWidth(),height:this.helper.outerHeight()};}});b("_mouseStart",function(){if(this._helper){this.size={width:this.size.width-(this.helper.outerWidth()-this.helper.width()),height:this.size.height-(this.helper.outerHeight()-this.helper.height())};this.originalSize={width:this.size.width,height:this.size.height};}});b("_renderProxy",function(){if(this._helper)this.helper.css({left:this.elementOffset.left,top:this.elementOffset.top,width:this.element.outerWidth(),height:this.element.outerHeight()});});var g=a.ui.resizable.prototype.plugins.resize;a.each(g,function(a,b){if(b[0]=="ghost"){g.splice(a,1);return false;}});a.each(a.ui.resizable.prototype.plugins.start,function(b,c){if(c[0]=="ghost"){var d=c[1];c[1]=function(){d.apply(this,arguments);a(this).data("resizable").ghost.css({width:"100%",height:"100%"});};return false;}});})(jQuery);